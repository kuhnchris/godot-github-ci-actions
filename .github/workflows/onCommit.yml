name: Conversion & build job(s)
on: push
#on: 
#  push:
#    branches:
#      - main

jobs:
  build:
    name: Loading engine, templates and build project (X11)
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
      with:
        ref: main
        path: main
        token: ${{ secrets.MY_TOKEN || github.token }}

    - name: Fetch godot version
      id: fetchGodot
      uses: ./main/.github/actions/fetchGodot
      with:
        godot-version: 3.4

    - name: Build release
      id: exportGodot
      uses: ./main/.github/actions/exportGodotProject
      with:
        project-directory: "./main/example-project"
        export-debug: false
        export-pack: false
        export-platform: "Linux/X11"

    - name: Release
      uses: softprops/action-gh-release@v1
      #if: startsWith(github.ref, 'refs/tags/')
      with:
        body: |
          This is an automated build for GitHub SHA ${{ github.sha }}
        tag_name: latest-dev
        files: |
          ./export-artifacts/*